!function(t,n){var e={Identity:function(t){return t},True:function(){return!0},Blank:function(){}},r={Boolean:typeof!0,Number:"number",String:"string",Object:typeof{},Undefined:typeof n,Function:"function"},o={"":e.Identity},u={createLambda:function(t){if(null==t)return e.Identity;if(typeof t===r.String){var n=o[t];if(null!=n)return n;if(-1===t.indexOf("=>")){for(var u,i=new RegExp("[$]+","g"),c=0;null!=(u=i.exec(t));){var a=u[0].length;a>c&&(c=a)}for(var f=[],s=1;c>=s;s++){for(var l="",p=0;s>p;p++)l+="$";f.push(l)}var h=Array.prototype.join.call(f,",");return n=new Function(h,"return "+t),o[t]=n,n}var y=t.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return n=new Function(y[1],"return "+y[2]),o[t]=n,n}return t},isIEnumerable:function(t){if(typeof Enumerator!==r.Undefined)try{return new Enumerator(t),!0}catch(n){}return!1},defineProperty:null!=Object.defineProperties?function(t,n,e){Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:e})}:function(t,n,e){t[n]=e},compare:function(t,n){return t===n?0:t>n?1:-1},dispose:function(t){null!=t&&t.dispose()}},i={Before:0,Running:1,After:2},c=function(t,n,e){var r=new a,o=i.Before;this.current=r.current,this.moveNext=function(){try{switch(o){case i.Before:o=i.Running,t();case i.Running:return n.apply(r)?!0:(this.dispose(),!1);case i.After:return!1}}catch(e){throw this.dispose(),e}},this.dispose=function(){if(o==i.Running)try{e()}finally{o=i.After}}},a=function(){var t=null;this.current=function(){return t},this.yieldReturn=function(n){return t=n,!0},this.yieldBreak=function(){return!1}},f=function(t){this.getEnumerator=t};f.Utils={},f.Utils.createLambda=function(t){return u.createLambda(t)},f.Utils.createEnumerable=function(t){return new f(t)},f.Utils.createEnumerator=function(t,n,e){return new c(t,n,e)},f.Utils.extendTo=function(t){var n,e=t.prototype;t===Array?(n=h.prototype,u.defineProperty(e,"getSource",function(){return this})):(n=f.prototype,u.defineProperty(e,"getEnumerator",function(){return f.from(this).getEnumerator()}));for(var r in n){var o=n[r];e[r]!=o&&(null!=e[r]&&(r+="ByLinq",e[r]==o)||o instanceof Function&&u.defineProperty(e,r,o))}},f.choice=function(){var t=arguments;return new f(function(){return new c(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return this.yieldReturn(t[Math.floor(Math.random()*t.length)])},e.Blank)})},f.cycle=function(){var t=arguments;return new f(function(){var n=0;return new c(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return n>=t.length&&(n=0),this.yieldReturn(t[n++])},e.Blank)})},f.empty=function(){return new f(function(){return new c(e.Blank,function(){return!1},e.Blank)})},f.from=function(t){if(null==t)return f.empty();if(t instanceof f)return t;if(typeof t==r.Number||typeof t==r.Boolean)return f.repeat(t,1);if(typeof t==r.String)return new f(function(){var n=0;return new c(e.Blank,function(){return n<t.length?this.yieldReturn(t.charAt(n++)):!1},e.Blank)});if(typeof t!=r.Function){if(typeof t.length==r.Number)return new h(t);if(!(t instanceof Object)&&u.isIEnumerable(t))return new f(function(){var n,r=!0;return new c(function(){n=new Enumerator(t)},function(){return r?r=!1:n.moveNext(),n.atEnd()?!1:this.yieldReturn(n.item())},e.Blank)});if(typeof Windows===r.Object&&typeof t.first===r.Function)return new f(function(){var n,r=!0;return new c(function(){n=t.first()},function(){return r?r=!1:n.moveNext(),n.hasCurrent?this.yieldReturn(n.current):this.yieldBreak()},e.Blank)})}return new f(function(){var n=[],r=0;return new c(function(){for(var e in t){var r=t[e];r instanceof Function||!Object.prototype.hasOwnProperty.call(t,e)||n.push({key:e,value:r})}},function(){return r<n.length?this.yieldReturn(n[r++]):!1},e.Blank)})},f.make=function(t){return f.repeat(t,1)},f.matches=function(t,n,r){return null==r&&(r=""),n instanceof RegExp&&(r+=n.ignoreCase?"i":"",r+=n.multiline?"m":"",n=n.source),-1===r.indexOf("g")&&(r+="g"),new f(function(){var o;return new c(function(){o=new RegExp(n,r)},function(){var n=o.exec(t);return n?this.yieldReturn(n):!1},e.Blank)})},f.range=function(t,n,r){return null==r&&(r=1),new f(function(){var o,u=0;return new c(function(){o=t-r},function(){return u++<n?this.yieldReturn(o+=r):this.yieldBreak()},e.Blank)})},f.rangeDown=function(t,n,r){return null==r&&(r=1),new f(function(){var o,u=0;return new c(function(){o=t+r},function(){return u++<n?this.yieldReturn(o-=r):this.yieldBreak()},e.Blank)})},f.rangeTo=function(t,n,r){return null==r&&(r=1),new f(n>t?function(){var o;return new c(function(){o=t-r},function(){var t=o+=r;return n>=t?this.yieldReturn(t):this.yieldBreak()},e.Blank)}:function(){var o;return new c(function(){o=t+r},function(){var t=o-=r;return t>=n?this.yieldReturn(t):this.yieldBreak()},e.Blank)})},f.repeat=function(t,n){return null!=n?f.repeat(t).take(n):new f(function(){return new c(e.Blank,function(){return this.yieldReturn(t)},e.Blank)})},f.repeatWithFinalize=function(t,n){return t=u.createLambda(t),n=u.createLambda(n),new f(function(){var e;return new c(function(){e=t()},function(){return this.yieldReturn(e)},function(){null!=e&&(n(e),e=null)})})},f.generate=function(t,n){return null!=n?f.generate(t).take(n):(t=u.createLambda(t),new f(function(){return new c(e.Blank,function(){return this.yieldReturn(t())},e.Blank)}))},f.toInfinity=function(t,n){return null==t&&(t=0),null==n&&(n=1),new f(function(){var r;return new c(function(){r=t-n},function(){return this.yieldReturn(r+=n)},e.Blank)})},f.toNegativeInfinity=function(t,n){return null==t&&(t=0),null==n&&(n=1),new f(function(){var r;return new c(function(){r=t+n},function(){return this.yieldReturn(r-=n)},e.Blank)})},f.unfold=function(t,n){return n=u.createLambda(n),new f(function(){var r,o=!0;return new c(e.Blank,function(){return o?(o=!1,r=t,this.yieldReturn(r)):(r=n(r),this.yieldReturn(r))},e.Blank)})},f.defer=function(t){return new f(function(){var n;return new c(function(){n=f.from(t()).getEnumerator()},function(){return n.moveNext()?this.yieldReturn(n.current()):this.yieldBreak()},function(){u.dispose(n)})})},f.prototype.traverseBreadthFirst=function(t,n){var e=this;return t=u.createLambda(t),n=u.createLambda(n),new f(function(){var r,o=0,i=[];return new c(function(){r=e.getEnumerator()},function(){for(;;){if(r.moveNext())return i.push(r.current()),this.yieldReturn(n(r.current(),o));var e=f.from(i).selectMany(function(n){return t(n)});if(!e.any())return!1;o++,i=[],u.dispose(r),r=e.getEnumerator()}},function(){u.dispose(r)})})},f.prototype.traverseDepthFirst=function(t,n){var e=this;return t=u.createLambda(t),n=u.createLambda(n),new f(function(){var r,o=[];return new c(function(){r=e.getEnumerator()},function(){for(;;){if(r.moveNext()){var e=n(r.current(),o.length);return o.push(r),r=f.from(t(r.current())).getEnumerator(),this.yieldReturn(e)}if(o.length<=0)return!1;u.dispose(r),r=o.pop()}},function(){try{u.dispose(r)}finally{f.from(o).forEach(function(t){t.dispose()})}})})},f.prototype.flatten=function(){var t=this;return new f(function(){var n,r=null;return new c(function(){n=t.getEnumerator()},function(){for(;;){if(null!=r){if(r.moveNext())return this.yieldReturn(r.current());r=null}if(n.moveNext()){if(n.current()instanceof Array){u.dispose(r),r=f.from(n.current()).selectMany(e.Identity).flatten().getEnumerator();continue}return this.yieldReturn(n.current())}return!1}},function(){try{u.dispose(n)}finally{u.dispose(r)}})})},f.prototype.pairwise=function(t){var n=this;return t=u.createLambda(t),new f(function(){var e;return new c(function(){e=n.getEnumerator(),e.moveNext()},function(){var n=e.current();return e.moveNext()?this.yieldReturn(t(n,e.current())):!1},function(){u.dispose(e)})})},f.prototype.scan=function(t,n){var e;null==n?(n=u.createLambda(t),e=!1):(n=u.createLambda(n),e=!0);var r=this;return new f(function(){var o,i,a=!0;return new c(function(){o=r.getEnumerator()},function(){if(a){if(a=!1,e)return this.yieldReturn(i=t);if(o.moveNext())return this.yieldReturn(i=o.current())}return o.moveNext()?this.yieldReturn(i=n(i,o.current())):!1},function(){u.dispose(o)})})},f.prototype.select=function(t){if(t=u.createLambda(t),t.length<=1)return new d(this,null,t);var n=this;return new f(function(){var e,r=0;return new c(function(){e=n.getEnumerator()},function(){return e.moveNext()?this.yieldReturn(t(e.current(),r++)):!1},function(){u.dispose(e)})})},f.prototype.selectMany=function(t,e){var r=this;return t=u.createLambda(t),null==e&&(e=function(t,n){return n}),e=u.createLambda(e),new f(function(){var o,i=n,a=0;return new c(function(){o=r.getEnumerator()},function(){if(i===n&&!o.moveNext())return!1;do{if(null==i){var r=t(o.current(),a++);i=f.from(r).getEnumerator()}if(i.moveNext())return this.yieldReturn(e(o.current(),i.current()));u.dispose(i),i=null}while(o.moveNext());return!1},function(){try{u.dispose(o)}finally{u.dispose(i)}})})},f.prototype.where=function(t){if(t=u.createLambda(t),t.length<=1)return new y(this,t);var n=this;return new f(function(){var e,r=0;return new c(function(){e=n.getEnumerator()},function(){for(;e.moveNext();)if(t(e.current(),r++))return this.yieldReturn(e.current());return!1},function(){u.dispose(e)})})},f.prototype.choose=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e,r=0;return new c(function(){e=n.getEnumerator()},function(){for(;e.moveNext();){var n=t(e.current(),r++);if(null!=n)return this.yieldReturn(n)}return this.yieldBreak()},function(){u.dispose(e)})})},f.prototype.ofType=function(t){var n;switch(t){case Number:n=r.Number;break;case String:n=r.String;break;case Boolean:n=r.Boolean;break;case Function:n=r.Function;break;default:n=null}return null===n?this.where(function(n){return n instanceof t}):this.where(function(t){return typeof t===n})},f.prototype.zip=function(){var t=arguments,n=u.createLambda(arguments[arguments.length-1]),e=this;if(2==arguments.length){var r=arguments[0];return new f(function(){var t,o,i=0;return new c(function(){t=e.getEnumerator(),o=f.from(r).getEnumerator()},function(){return t.moveNext()&&o.moveNext()?this.yieldReturn(n(t.current(),o.current(),i++)):!1},function(){try{u.dispose(t)}finally{u.dispose(o)}})})}return new f(function(){var r,o=0;return new c(function(){var n=f.make(e).concat(f.from(t).takeExceptLast().select(f.from)).select(function(t){return t.getEnumerator()}).toArray();r=f.from(n)},function(){if(r.all(function(t){return t.moveNext()})){var t=r.select(function(t){return t.current()}).toArray();return t.push(o++),this.yieldReturn(n.apply(null,t))}return this.yieldBreak()},function(){f.from(r).forEach(u.dispose)})})},f.prototype.merge=function(){var t=arguments,n=this;return new f(function(){var e,r=-1;return new c(function(){e=f.make(n).concat(f.from(t).select(f.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;e.length>0;){r=r>=e.length-1?0:r+1;var t=e[r];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),e.splice(r--,1)}return this.yieldBreak()},function(){f.from(e).forEach(u.dispose)})})},f.prototype.join=function(t,r,o,i,a){r=u.createLambda(r),o=u.createLambda(o),i=u.createLambda(i),a=u.createLambda(a);var s=this;return new f(function(){var l,p,h=null,y=0;return new c(function(){l=s.getEnumerator(),p=f.from(t).toLookup(o,e.Identity,a)},function(){for(;;){if(null!=h){var t=h[y++];if(t!==n)return this.yieldReturn(i(l.current(),t));t=null,y=0}if(!l.moveNext())return!1;var e=r(l.current());h=p.get(e).toArray()}},function(){u.dispose(l)})})},f.prototype.groupJoin=function(t,n,r,o,i){n=u.createLambda(n),r=u.createLambda(r),o=u.createLambda(o),i=u.createLambda(i);var a=this;return new f(function(){var s=a.getEnumerator(),l=null;return new c(function(){s=a.getEnumerator(),l=f.from(t).toLookup(r,e.Identity,i)},function(){if(s.moveNext()){var t=l.get(n(s.current()));return this.yieldReturn(o(s.current(),t))}return!1},function(){u.dispose(s)})})},f.prototype.all=function(t){t=u.createLambda(t);var n=!0;return this.forEach(function(e){return t(e)?void 0:(n=!1,!1)}),n},f.prototype.any=function(t){t=u.createLambda(t);var n=this.getEnumerator();try{if(0==arguments.length)return n.moveNext();for(;n.moveNext();)if(t(n.current()))return!0;return!1}finally{u.dispose(n)}},f.prototype.isEmpty=function(){return!this.any()},f.prototype.concat=function(){var t=this;if(1==arguments.length){var n=arguments[0];return new f(function(){var e,r;return new c(function(){e=t.getEnumerator()},function(){if(null==r){if(e.moveNext())return this.yieldReturn(e.current());r=f.from(n).getEnumerator()}return r.moveNext()?this.yieldReturn(r.current()):!1},function(){try{u.dispose(e)}finally{u.dispose(r)}})})}var e=arguments;return new f(function(){var n;return new c(function(){n=f.make(t).concat(f.from(e).select(f.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;n.length>0;){var t=n[0];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),n.splice(0,1)}return this.yieldBreak()},function(){f.from(n).forEach(u.dispose)})})},f.prototype.insert=function(t,n){var e=this;return new f(function(){var r,o,i=0,a=!1;return new c(function(){r=e.getEnumerator(),o=f.from(n).getEnumerator()},function(){return i==t&&o.moveNext()?(a=!0,this.yieldReturn(o.current())):r.moveNext()?(i++,this.yieldReturn(r.current())):!a&&o.moveNext()?this.yieldReturn(o.current()):!1},function(){try{u.dispose(r)}finally{u.dispose(o)}})})},f.prototype.alternate=function(t){var n=this;return new f(function(){var e,r,o,i;return new c(function(){o=t instanceof Array||null!=t.getEnumerator?f.from(f.from(t).toArray()):f.make(t),r=n.getEnumerator(),r.moveNext()&&(e=r.current())},function(){for(;;){if(null!=i){if(i.moveNext())return this.yieldReturn(i.current());i=null}{if(null!=e||!r.moveNext()){if(null!=e){var t=e;return e=null,this.yieldReturn(t)}return this.yieldBreak()}e=r.current(),i=o.getEnumerator()}}},function(){try{u.dispose(r)}finally{u.dispose(i)}})})},f.prototype.contains=function(t,n){n=u.createLambda(n);var e=this.getEnumerator();try{for(;e.moveNext();)if(n(e.current())===t)return!0;return!1}finally{u.dispose(e)}},f.prototype.defaultIfEmpty=function(t){var e=this;return t===n&&(t=null),new f(function(){var n,r=!0;return new c(function(){n=e.getEnumerator()},function(){return n.moveNext()?(r=!1,this.yieldReturn(n.current())):r?(r=!1,this.yieldReturn(t)):!1},function(){u.dispose(n)})})},f.prototype.distinct=function(t){return this.except(f.empty(),t)},f.prototype.distinctUntilChanged=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e,r,o;return new c(function(){e=n.getEnumerator()},function(){for(;e.moveNext();){var n=t(e.current());if(o)return o=!1,r=n,this.yieldReturn(e.current());if(r!==n)return r=n,this.yieldReturn(e.current())}return this.yieldBreak()},function(){u.dispose(e)})})},f.prototype.except=function(t,n){n=u.createLambda(n);var e=this;return new f(function(){var r,o;return new c(function(){r=e.getEnumerator(),o=new m(n),f.from(t).forEach(function(t){o.add(t)})},function(){for(;r.moveNext();){var t=r.current();if(!o.contains(t))return o.add(t),this.yieldReturn(t)}return!1},function(){u.dispose(r)})})},f.prototype.intersect=function(t,n){n=u.createLambda(n);var e=this;return new f(function(){var r,o,i;return new c(function(){r=e.getEnumerator(),o=new m(n),f.from(t).forEach(function(t){o.add(t)}),i=new m(n)},function(){for(;r.moveNext();){var t=r.current();if(!i.contains(t)&&o.contains(t))return i.add(t),this.yieldReturn(t)}return!1},function(){u.dispose(r)})})},f.prototype.sequenceEqual=function(t,n){n=u.createLambda(n);var e=this.getEnumerator();try{var r=f.from(t).getEnumerator();try{for(;e.moveNext();)if(!r.moveNext()||n(e.current())!==n(r.current()))return!1;return!r.moveNext()}finally{u.dispose(r)}}finally{u.dispose(e)}},f.prototype.union=function(t,e){e=u.createLambda(e);var r=this;return new f(function(){var o,i,a;return new c(function(){o=r.getEnumerator(),a=new m(e)},function(){var e;if(i===n){for(;o.moveNext();)if(e=o.current(),!a.contains(e))return a.add(e),this.yieldReturn(e);i=f.from(t).getEnumerator()}for(;i.moveNext();)if(e=i.current(),!a.contains(e))return a.add(e),this.yieldReturn(e);return!1},function(){try{u.dispose(o)}finally{u.dispose(i)}})})},f.prototype.orderBy=function(t){return new s(this,t,!1)},f.prototype.orderByDescending=function(t){return new s(this,t,!0)},f.prototype.reverse=function(){var t=this;return new f(function(){var n,r;return new c(function(){n=t.toArray(),r=n.length},function(){return r>0?this.yieldReturn(n[--r]):!1},e.Blank)})},f.prototype.shuffle=function(){var t=this;return new f(function(){var n;return new c(function(){n=t.toArray()},function(){if(n.length>0){var t=Math.floor(Math.random()*n.length);return this.yieldReturn(n.splice(t,1)[0])}return!1},e.Blank)})},f.prototype.weightedSample=function(t){t=u.createLambda(t);var n=this;return new f(function(){var r,o=0;return new c(function(){r=n.choose(function(n){var e=t(n);return 0>=e?null:(o+=e,{value:n,bound:o})}).toArray()},function(){if(r.length>0){for(var t=Math.floor(Math.random()*o)+1,n=-1,e=r.length;e-n>1;){var u=Math.floor((n+e)/2);r[u].bound>=t?e=u:n=u}return this.yieldReturn(r[e].value)}return this.yieldBreak()},e.Blank)})},f.prototype.groupBy=function(t,n,e,r){var o=this;return t=u.createLambda(t),n=u.createLambda(n),null!=e&&(e=u.createLambda(e)),r=u.createLambda(r),new f(function(){var i;return new c(function(){i=o.toLookup(t,n,r).toEnumerable().getEnumerator()},function(){for(;i.moveNext();)return null==e?this.yieldReturn(i.current()):this.yieldReturn(e(i.current().key(),i.current()));return!1},function(){u.dispose(i)})})},f.prototype.partitionBy=function(t,n,e,r){var o=this;t=u.createLambda(t),n=u.createLambda(n),r=u.createLambda(r);var i;return null==e?(i=!1,e=function(t,n){return new g(t,n)}):(i=!0,e=u.createLambda(e)),new f(function(){var a,s,l,p=[];return new c(function(){a=o.getEnumerator(),a.moveNext()&&(s=t(a.current()),l=r(s),p.push(n(a.current())))},function(){for(var o;1==(o=a.moveNext())&&l===r(t(a.current()));)p.push(n(a.current()));if(p.length>0){var u=i?e(s,f.from(p)):e(s,p);return o?(s=t(a.current()),l=r(s),p=[n(a.current())]):p=[],this.yieldReturn(u)}return!1},function(){u.dispose(a)})})},f.prototype.buffer=function(t){var n=this;return new f(function(){var e;return new c(function(){e=n.getEnumerator()},function(){for(var n=[],r=0;e.moveNext();)if(n.push(e.current()),++r>=t)return this.yieldReturn(n);return n.length>0?this.yieldReturn(n):!1},function(){u.dispose(e)})})},f.prototype.aggregate=function(t,n,e){return(e=u.createLambda(e))(this.scan(t,n,e).last())},f.prototype.average=function(t){t=u.createLambda(t);var n=0,e=0;return this.forEach(function(r){n+=t(r),++e}),n/e},f.prototype.count=function(t){t=null==t?e.True:u.createLambda(t);var n=0;return this.forEach(function(e,r){t(e,r)&&++n}),n},f.prototype.max=function(t){return null==t&&(t=e.Identity),this.select(t).aggregate(function(t,n){return t>n?t:n})},f.prototype.min=function(t){return null==t&&(t=e.Identity),this.select(t).aggregate(function(t,n){return n>t?t:n})},f.prototype.maxBy=function(t){return t=u.createLambda(t),this.aggregate(function(n,e){return t(n)>t(e)?n:e})},f.prototype.minBy=function(t){return t=u.createLambda(t),this.aggregate(function(n,e){return t(n)<t(e)?n:e})},f.prototype.sum=function(t){return null==t&&(t=e.Identity),this.select(t).aggregate(0,function(t,n){return t+n})},f.prototype.elementAt=function(t){var n,e=!1;if(this.forEach(function(r,o){return o==t?(n=r,e=!0,!1):void 0}),!e)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return n},f.prototype.elementAtOrDefault=function(t,e){e===n&&(e=null);var r,o=!1;return this.forEach(function(n,e){return e==t?(r=n,o=!0,!1):void 0}),o?r:e},f.prototype.first=function(t){if(null!=t)return this.where(t).first();var n,e=!1;if(this.forEach(function(t){return n=t,e=!0,!1}),!e)throw new Error("first:No element satisfies the condition.");return n},f.prototype.firstOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return this.where(t).firstOrDefault(null,e);var r,o=!1;return this.forEach(function(t){return r=t,o=!0,!1}),o?r:e},f.prototype.last=function(t){if(null!=t)return this.where(t).last();var n,e=!1;if(this.forEach(function(t){e=!0,n=t}),!e)throw new Error("last:No element satisfies the condition.");return n},f.prototype.lastOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return this.where(t).lastOrDefault(null,e);var r,o=!1;return this.forEach(function(t){o=!0,r=t}),o?r:e},f.prototype.single=function(t){if(null!=t)return this.where(t).single();var n,e=!1;if(this.forEach(function(t){if(e)throw new Error("single:sequence contains more than one element.");e=!0,n=t}),!e)throw new Error("single:No element satisfies the condition.");return n},f.prototype.singleOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return this.where(t).singleOrDefault(null,e);var r,o=!1;return this.forEach(function(t){if(o)throw new Error("single:sequence contains more than one element.");o=!0,r=t}),o?r:e},f.prototype.skip=function(t){var n=this;return new f(function(){var e,r=0;return new c(function(){for(e=n.getEnumerator();r++<t&&e.moveNext(););},function(){return e.moveNext()?this.yieldReturn(e.current()):!1},function(){u.dispose(e)})})},f.prototype.skipWhile=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e,r=0,o=!1;return new c(function(){e=n.getEnumerator()},function(){for(;!o;){if(!e.moveNext())return!1;if(!t(e.current(),r++))return o=!0,this.yieldReturn(e.current())}return e.moveNext()?this.yieldReturn(e.current()):!1},function(){u.dispose(e)})})},f.prototype.take=function(t){var n=this;return new f(function(){var e,r=0;return new c(function(){e=n.getEnumerator()},function(){return r++<t&&e.moveNext()?this.yieldReturn(e.current()):!1},function(){u.dispose(e)})})},f.prototype.takeWhile=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e,r=0;return new c(function(){e=n.getEnumerator()},function(){return e.moveNext()&&t(e.current(),r++)?this.yieldReturn(e.current()):!1},function(){u.dispose(e)})})},f.prototype.takeExceptLast=function(t){null==t&&(t=1);var n=this;return new f(function(){if(0>=t)return n.getEnumerator();var e,r=[];return new c(function(){e=n.getEnumerator()},function(){for(;e.moveNext();){if(r.length==t)return r.push(e.current()),this.yieldReturn(r.shift());r.push(e.current())}return!1},function(){u.dispose(e)})})},f.prototype.takeFromLast=function(t){if(0>=t||null==t)return f.empty();var n=this;return new f(function(){var e,r,o=[];return new c(function(){e=n.getEnumerator()},function(){for(;e.moveNext();)o.length==t&&o.shift(),o.push(e.current());return null==r&&(r=f.from(o).getEnumerator()),r.moveNext()?this.yieldReturn(r.current()):!1},function(){u.dispose(r)})})},f.prototype.indexOf=function(t){var n=null;return typeof t===r.Function?this.forEach(function(e,r){return t(e,r)?(n=r,!1):void 0}):this.forEach(function(e,r){return e===t?(n=r,!1):void 0}),null!==n?n:-1},f.prototype.lastIndexOf=function(t){var n=-1;return typeof t===r.Function?this.forEach(function(e,r){t(e,r)&&(n=r)}):this.forEach(function(e,r){e===t&&(n=r)}),n},f.prototype.cast=function(){return this},f.prototype.asEnumerable=function(){return f.from(this)},f.prototype.toArray=function(){var t=[];return this.forEach(function(n){t.push(n)}),t},f.prototype.toLookup=function(t,e,r){t=u.createLambda(t),e=u.createLambda(e),r=u.createLambda(r);var o=new m(r);return this.forEach(function(r){var u=t(r),i=e(r),c=o.get(u);c!==n?c.push(i):o.add(u,[i])}),new v(o)},f.prototype.toObject=function(t,n){t=u.createLambda(t),n=u.createLambda(n);var e={};return this.forEach(function(r){e[t(r)]=n(r)}),e},f.prototype.toDictionary=function(t,n,e){t=u.createLambda(t),n=u.createLambda(n),e=u.createLambda(e);var r=new m(e);return this.forEach(function(e){r.add(t(e),n(e))}),r},f.prototype.toJSONString=function(t,n){if(typeof JSON===r.Undefined||null==JSON.stringify)throw new Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js");return JSON.stringify(this.toArray(),t,n)},f.prototype.toJoinedString=function(t,n){return null==t&&(t=""),null==n&&(n=e.Identity),this.select(n).toArray().join(t)},f.prototype.doAction=function(t){var n=this;return t=u.createLambda(t),new f(function(){var e,r=0;return new c(function(){e=n.getEnumerator()},function(){return e.moveNext()?(t(e.current(),r++),this.yieldReturn(e.current())):!1},function(){u.dispose(e)})})},f.prototype.forEach=function(t){t=u.createLambda(t);var n=0,e=this.getEnumerator();try{for(;e.moveNext()&&t(e.current(),n++)!==!1;);}finally{u.dispose(e)}},f.prototype.write=function(t,n){null==t&&(t=""),n=u.createLambda(n);var e=!0;this.forEach(function(r){e?e=!1:document.write(t),document.write(n(r))})},f.prototype.writeLine=function(t){t=u.createLambda(t),this.forEach(function(n){document.writeln(t(n)+"<br />")})},f.prototype.force=function(){var t=this.getEnumerator();try{for(;t.moveNext(););}finally{u.dispose(t)}},f.prototype.letBind=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e;return new c(function(){e=f.from(t(n)).getEnumerator()},function(){return e.moveNext()?this.yieldReturn(e.current()):!1},function(){u.dispose(e)})})},f.prototype.share=function(){var t,n=this,r=!1;return new p(function(){return new c(function(){null==t&&(t=n.getEnumerator())},function(){if(r)throw new Error("enumerator is disposed");return t.moveNext()?this.yieldReturn(t.current()):!1},e.Blank)},function(){r=!0,u.dispose(t)})},f.prototype.memoize=function(){var t,n,r=this,o=!1;return new p(function(){var u=-1;return new c(function(){null==n&&(n=r.getEnumerator(),t=[])},function(){if(o)throw new Error("enumerator is disposed");return u++,t.length<=u?n.moveNext()?this.yieldReturn(t[u]=n.current()):!1:this.yieldReturn(t[u])},e.Blank)},function(){o=!0,u.dispose(n),t=null})},f.prototype.catchError=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e;return new c(function(){e=n.getEnumerator()},function(){try{return e.moveNext()?this.yieldReturn(e.current()):!1}catch(n){return t(n),!1}},function(){u.dispose(e)})})},f.prototype.finallyAction=function(t){t=u.createLambda(t);var n=this;return new f(function(){var e;return new c(function(){e=n.getEnumerator()},function(){return e.moveNext()?this.yieldReturn(e.current()):!1},function(){try{u.dispose(e)}finally{t()}})})},f.prototype.log=function(t){return t=u.createLambda(t),this.doAction(function(n){typeof console!==r.Undefined&&console.log(t(n))})},f.prototype.trace=function(t,n){return null==t&&(t="Trace"),n=u.createLambda(n),this.doAction(function(e){typeof console!==r.Undefined&&console.log(t,n(e))})};var s=function(t,n,e,r){this.source=t,this.keySelector=u.createLambda(n),this.descending=e,this.parent=r};s.prototype=new f,s.prototype.createOrderedEnumerable=function(t,n){return new s(this.source,t,n,this)},s.prototype.thenBy=function(t){return this.createOrderedEnumerable(t,!1)},s.prototype.thenByDescending=function(t){return this.createOrderedEnumerable(t,!0)},s.prototype.getEnumerator=function(){var t,n,r=this,o=0;return new c(function(){t=[],n=[],r.source.forEach(function(e,r){t.push(e),n.push(r)});var e=l.create(r,null);e.GenerateKeys(t),n.sort(function(t,n){return e.compare(t,n)})},function(){return o<n.length?this.yieldReturn(t[n[o++]]):!1},e.Blank)};var l=function(t,n,e){this.keySelector=t,this.descending=n,this.child=e,this.keys=null};l.create=function(t,n){var e=new l(t.keySelector,t.descending,n);return null!=t.parent?l.create(t.parent,e):e},l.prototype.GenerateKeys=function(t){for(var n=t.length,e=this.keySelector,r=new Array(n),o=0;n>o;o++)r[o]=e(t[o]);this.keys=r,null!=this.child&&this.child.GenerateKeys(t)},l.prototype.compare=function(t,n){var e=u.compare(this.keys[t],this.keys[n]);return 0==e?null!=this.child?this.child.compare(t,n):u.compare(t,n):this.descending?-e:e};var p=function(t,n){this.dispose=n,f.call(this,t)};p.prototype=new f;var h=function(t){this.getSource=function(){return t}};h.prototype=new f,h.prototype.any=function(t){return null==t?this.getSource().length>0:f.prototype.any.apply(this,arguments)},h.prototype.count=function(t){return null==t?this.getSource().length:f.prototype.count.apply(this,arguments)},h.prototype.elementAt=function(t){var n=this.getSource();return t>=0&&t<n.length?n[t]:f.prototype.elementAt.apply(this,arguments)},h.prototype.elementAtOrDefault=function(t,e){e===n&&(e=null);var r=this.getSource();return t>=0&&t<r.length?r[t]:e},h.prototype.first=function(t){var n=this.getSource();return null==t&&n.length>0?n[0]:f.prototype.first.apply(this,arguments)},h.prototype.firstOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return f.prototype.firstOrDefault.apply(this,arguments);var r=this.getSource();return r.length>0?r[0]:e},h.prototype.last=function(t){var n=this.getSource();return null==t&&n.length>0?n[n.length-1]:f.prototype.last.apply(this,arguments)},h.prototype.lastOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return f.prototype.lastOrDefault.apply(this,arguments);var r=this.getSource();return r.length>0?r[r.length-1]:e},h.prototype.skip=function(t){var n=this.getSource();return new f(function(){var r;return new c(function(){r=0>t?0:t},function(){return r<n.length?this.yieldReturn(n[r++]):!1},e.Blank)})},h.prototype.takeExceptLast=function(t){return null==t&&(t=1),this.take(this.getSource().length-t)},h.prototype.takeFromLast=function(t){return this.skip(this.getSource().length-t)},h.prototype.reverse=function(){var t=this.getSource();return new f(function(){var n;return new c(function(){n=t.length},function(){return n>0?this.yieldReturn(t[--n]):!1},e.Blank)})},h.prototype.sequenceEqual=function(t,n){return(t instanceof h||t instanceof Array)&&null==n&&f.from(t).count()!=this.count()?!1:f.prototype.sequenceEqual.apply(this,arguments)},h.prototype.toJoinedString=function(t,n){var e=this.getSource();return null==n&&e instanceof Array?(null==t&&(t=""),e.join(t)):f.prototype.toJoinedString.apply(this,arguments)},h.prototype.getEnumerator=function(){var t=this.getSource(),n=-1;return{current:function(){return t[n]},moveNext:function(){return++n<t.length},dispose:e.Blank}};var y=function(t,n){this.prevSource=t,this.prevPredicate=n};y.prototype=new f,y.prototype.where=function(t){if(t=u.createLambda(t),t.length<=1){var n=this.prevPredicate,e=function(e){return n(e)&&t(e)};return new y(this.prevSource,e)}return f.prototype.where.call(this,t)},y.prototype.select=function(t){return t=u.createLambda(t),t.length<=1?new d(this.prevSource,this.prevPredicate,t):f.prototype.select.call(this,t)},y.prototype.getEnumerator=function(){var t,n=this.prevPredicate,e=this.prevSource;return new c(function(){t=e.getEnumerator()},function(){for(;t.moveNext();)if(n(t.current()))return this.yieldReturn(t.current());return!1},function(){u.dispose(t)})};var d=function(t,n,e){this.prevSource=t,this.prevPredicate=n,this.prevSelector=e};d.prototype=new f,d.prototype.where=function(t){return t=u.createLambda(t),t.length<=1?new y(this,t):f.prototype.where.call(this,t)},d.prototype.select=function(t){if(t=u.createLambda(t),t.length<=1){var n=this.prevSelector,e=function(e){return t(n(e))};return new d(this.prevSource,this.prevPredicate,e)}return f.prototype.select.call(this,t)},d.prototype.getEnumerator=function(){var t,n=this.prevPredicate,e=this.prevSelector,r=this.prevSource;return new c(function(){t=r.getEnumerator()},function(){for(;t.moveNext();)if(null==n||n(t.current()))return this.yieldReturn(e(t.current()));return!1},function(){u.dispose(t)})};var m=function(){var t=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o=function(t){return null===t?"null":t===n?"undefined":typeof t.toString===r.Function?t.toString():Object.prototype.toString.call(t)},u=function(t,n){this.key=t,this.value=n,this.prev=null,this.next=null},i=function(){this.first=null,this.last=null};i.prototype={addLast:function(t){null!=this.last?(this.last.next=t,t.prev=this.last,this.last=t):this.first=this.last=t;
},replace:function(t,n){null!=t.prev?(t.prev.next=n,n.prev=t.prev):this.first=n,null!=t.next?(t.next.prev=n,n.next=t.next):this.last=n},remove:function(t){null!=t.prev?t.prev.next=t.next:this.first=t.next,null!=t.next?t.next.prev=t.prev:this.last=t.prev}};var a=function(t){this.countField=0,this.entryList=new i,this.buckets={},this.compareSelector=null==t?e.Identity:t};return a.prototype={add:function(n,e){var r=this.compareSelector(n),i=o(r),c=new u(n,e);if(t(this.buckets,i)){for(var a=this.buckets[i],f=0;f<a.length;f++)if(this.compareSelector(a[f].key)===r)return this.entryList.replace(a[f],c),void(a[f]=c);a.push(c)}else this.buckets[i]=[c];this.countField++,this.entryList.addLast(c)},get:function(e){var r=this.compareSelector(e),u=o(r);if(!t(this.buckets,u))return n;for(var i=this.buckets[u],c=0;c<i.length;c++){var a=i[c];if(this.compareSelector(a.key)===r)return a.value}return n},set:function(n,e){var r=this.compareSelector(n),i=o(r);if(t(this.buckets,i))for(var c=this.buckets[i],a=0;a<c.length;a++)if(this.compareSelector(c[a].key)===r){var f=new u(n,e);return this.entryList.replace(c[a],f),c[a]=f,!0}return!1},contains:function(n){var e=this.compareSelector(n),r=o(e);if(!t(this.buckets,r))return!1;for(var u=this.buckets[r],i=0;i<u.length;i++)if(this.compareSelector(u[i].key)===e)return!0;return!1},clear:function(){this.countField=0,this.buckets={},this.entryList=new i},remove:function(n){var e=this.compareSelector(n),r=o(e);if(t(this.buckets,r))for(var u=this.buckets[r],i=0;i<u.length;i++)if(this.compareSelector(u[i].key)===e)return this.entryList.remove(u[i]),u.splice(i,1),0==u.length&&delete this.buckets[r],void this.countField--},count:function(){return this.countField},toEnumerable:function(){var t=this;return new f(function(){var n;return new c(function(){n=t.entryList.first},function(){if(null!=n){var t={key:n.key,value:n.value};return n=n.next,this.yieldReturn(t)}return!1},e.Blank)})}},a}(),v=function(t){this.count=function(){return t.count()},this.get=function(n){return f.from(t.get(n))},this.contains=function(n){return t.contains(n)},this.toEnumerable=function(){return t.toEnumerable().select(function(t){return new g(t.key,t.value)})}},g=function(t,n){this.key=function(){return t},h.call(this,n)};g.prototype=new h,typeof define===r.Function&&define.amd?define("linqjs",[],function(){return f}):typeof module!==r.Undefined&&module.exports?module.exports=f:t.Enumerable=f}(this);